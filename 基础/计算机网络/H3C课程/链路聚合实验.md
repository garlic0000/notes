## 链路聚合实验

### 实验拓扑

![20210112-1](/home/garlic/Desktop/笔记/图片/20210112-1.PNG)

### 实验需求

1. 按照图示配置PC3和PC4的IP地址
2. 在SW1和SW2的两条直连链路上配置链路聚合，实现链路冗余，并可以增加传输带宽
3. SW1和SW2之间的直连链路要配置为Trunk类型，允许所有vlan通过
4. 中断SW1和SW2之间的一条直连链路，测试PC3和PC4是否仍然能够继续访问

------

### 实验解法

1. **PC配置IP地址部分**

   ![20210112-2](/home/garlic/Desktop/笔记/图片/20210112-2.PNG)

   ![20210112-3](/home/garlic/Desktop/笔记/图片/20210112-3.PNG)

2. **在SW1和SW2的直连链路上配置链路聚合**

   　　*分析：SW1和SW2之间通过g1/0/1和g1/0/2接口直连，需要在两台交换机上分别创建聚合接口，并把g1/0/1和g1/0/2接口加入到聚合接口，形成链路聚合。被聚合的物理接口的vlan配置和接口类型要保持一致，所以在配置链路聚合前，物理端口不要做任何其他配置，保持默认状态即可*

   *步骤1：在SW1上创建`Bridge-Aggregation 1`号聚合接口*

   ![20210112-4](/home/garlic/Desktop/笔记/图片/20210112-4.PNG)

   *步骤2：进入g1/0/1和g1/0/2接口的接口视图，分别把两个接口加入到聚合接口*

   ![20210112-5](/home/garlic/Desktop/笔记/图片/20210112-5.PNG)

   ![20210112-6](/home/garlic/Desktop/笔记/图片/20210112-6.PNG)

   *步骤3：查看链路聚合状态，发现已经成功运行*

   ![20210112-7](/home/garlic/Desktop/笔记/图片/20210112-7.PNG)

   *步骤4：SW2上命令与SW1上完全一致*

   ![20210112-8](/home/garlic/Desktop/笔记/图片/20210112-8.PNG)

   ![20210112-9](/home/garlic/Desktop/笔记/图片/20210112-9.PNG)

3. **SW1和SW2之间的直连链路要配置为Trunk类型，允许所有vlan通过**

   　　*分析：物理接口加入到聚合接口后，会自动继承聚合接口的vlan相关配置，所以不需要在物理接口上分别配置Trunk，只需要在聚合接口下配置Trunk即可*

   *步骤1：在SW1的`Bridge-Aggregation 1`接口的接口视图下，把该聚合接口配置为Trunk，并允许所有vlan通过。命令执行完毕后，会显示配置已经在g1/0/1和g1/0/2接口上自动完成*

   ![20210112-10](/home/garlic/Desktop/笔记/图片/20210112-10.PNG)

   *步骤2：SW2上命令与SW1上完全一致*

   ![20210112-11](/home/garlic/Desktop/笔记/图片/20210112-11.PNG)

4. 中断SW1和SW2之间的一条直连链路，测试PC3和PC4是否仍然能够继续访问

   　　*分析：链路聚合会自动把SW1和SW2之间的流量进行负载均衡，某一条链路中断连接后，也仍然还有另外一条链路可以继续通讯，所以PC3和PC4可以继续访问*

   *步骤1：进入SW1的g1/0/1接口的接口视图，使用`shutdown`命令关闭接口*

   ![20210112-12](/home/garlic/Desktop/笔记/图片/20210112-12.PNG)

   *步骤2：测试结果，PC3仍然可以Ping通PC4*

   ![20210112-13](/home/garlic/Desktop/笔记/图片/20210112-13.PNG)