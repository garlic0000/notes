## STP实验

### 实验拓扑

![20200111-1](/home/garlic/Desktop/笔记/图片/20200111-1.PNG)

### 实验需求

1. 开启所有设备，等待STP收敛后观察STP状态
2. 使SW4成为根网桥
3. 使闭塞端口出现在SW2上
4. 把SW1上连接的PC的端口配置为边缘端口

------

### 实验解法

1. **等待STP收敛后，查看STP运行状态，找出根网桥，闭塞端口**

   *步骤1：根据HCL模拟器的运行机制，SW1的Mac地址应该是最小的，会成为根网桥，在SW1上查看STP运行状态，确认SW1为根网桥*

   ![20200111-2](/home/garlic/Desktop/笔记/图片/20200111-2.PNG)

   ![20200111-3](/home/garlic/Desktop/笔记/图片/20200111-3.PNG)

   ![20200111-4](/home/garlic/Desktop/笔记/图片/20200111-4.PNG)

   ![20200111-5](/home/garlic/Desktop/笔记/图片/20200111-5.PNG)

   *步骤2：根据STP计算机制，所有链路开销一致，闭塞端口应该会出现在SW4上。在SW4上查看端口状态，确认SW4的g1/0/2被闭塞*

   ![20200111-6](/home/garlic/Desktop/笔记/图片/20200111-6.PNG)

2. **使SW4成为新的根网桥**

   　　*分析：要想使SW4成为根网桥，最好的办法就是让SW4的优先级成为全网最小。默认优先级都为32768，只要把SW4的优先级改成比32768小就可以了*

   *步骤1：修改SW4的优先级为4096*

   ![20200111-7](/home/garlic/Desktop/笔记/图片/20200111-7.PNG)

   *步骤2：在SW4上查看STP运行状态，发现SW4已经成为新的根网桥*

   ![20200111-8](/home/garlic/Desktop/笔记/图片/20200111-8.PNG)

3. **使闭塞端口出现在SW2上**

   　　*分析：SW4成为了根网桥，按照STP计算机制，闭塞端口此时应该在SW1上。要使闭塞端口到SW2上，就需要让SW2到SW1的cost比SW4到SW1更大。H3C交换机千兆口的cost默认是20，我们可以把SW2的g1/0/2接口的cost改为1000*

   *步骤1：在SW2上进入g1/0/2接口的接口视图，修改stp cost为1000*

   *![20200111-9](/home/garlic/Desktop/笔记/图片/20200111-9.PNG)步骤2：在SW2上查看STP接口状态，发现SW2的g1/0/2接口已经成为了新的闭塞端口*

   ![20200111-10](/home/garlic/Desktop/笔记/图片/20200111-10.PNG)

4. **把SW1连接PC的所有接口配置为边缘接口**

   ![20200111-11](/home/garlic/Desktop/笔记/图片/20200111-11.PNG)

   ![20200111-12](/home/garlic/Desktop/笔记/图片/20200111-12.PNG)