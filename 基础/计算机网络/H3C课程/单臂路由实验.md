## 单臂路由实验

### 实验拓扑

![20210113-1](/home/garlic/Desktop/笔记/图片/20210113-1.PNG)

### 实验需求

1. 按照图示为 PC3 和 PC4 配置 IP 地址和网关
2. PC3 属于 Vlan10，PC4 属于 Vlan20，配置单臂路由实现 Vlan10 和 Vlan20 三层互通
3. PC3 和 PC4 可以互通

------

### 实验解法

1. **PC 配置 IP 地址**

   ![20210113-2](/home/garlic/Desktop/笔记/图片/20210113-2.PNG)

   ![20210113-3](/home/garlic/Desktop/笔记/图片/20210113-3.PNG)

2. **PC3 属于 Vlan10，PC4 属于 Vlan20，配置单臂路由实现 Vlan10 和 Vlan20 三层互通**

   　　*分析：用单臂路由实现 Vlan 间三层互通，需要把 SW2 连接 R1 的接口配置为 Trunk，并允许 Vlan10 和 Vlan20 通过
   　　R1 连接 SW2 的接口上要开启子接口，分别作为 Vlan10 和 Vlan20 的网关。这里规划 g0/0.1 子接口作为 Vlan10 的网关，IP 地址就是`192.168.1.254/24`，g0/0.2 子接口作为 Vlan20 的网关，IP 地址就是`192.168.2.254/24`
   　　R1 的子接口上为了能够识别 SW2 的 Trunk 端口发送的 802.1Q 帧，还需要开启 dot1q 识别并绑定相应 Vlan。根据上述分析，g0/0.1 子接口绑定 Vlan10，g0/0.2 子接口绑定 Vlan20*
   　　
   *步骤 1：在 SW2 上创建 Vlan10 和 Vlan20，并把 g1/0/1 接口加入 Vlan10，把 g1/0/2 接口加入 Vlan20*

   ![20210113-4](/home/garlic/Desktop/笔记/图片/20210113-4.PNG)

   *步骤 2：把 SW2 的 g1/0/3 接口配置为 Trunk，并允许 Vlan10 和 Vlan20 通过*

   ![20210113-5](/home/garlic/Desktop/笔记/图片/20210113-5.PNG)

   *步骤 3：在 R1 上创建子接口 g0/0.1，开启 dot1q 识别，绑定到 Vlan10，并配置 IP 地址 `192.168.1.254/24`*

   ![20210113-6](/home/garlic/Desktop/笔记/图片/20210113-6.PNG)

   *步骤 4：在 R1 上创建子接口 0/0.2，开启 dot1q 识别，绑定到 Vlan20，并配置 IP 地址`192.168.2.254/24`*

   ![20210113-7](/home/garlic/Desktop/笔记/图片/20210113-7.PNG)

   　　*分析：配置结束后，在 R1 上查看路由表，会发现已经产生了到达`192.168.1.0/24`网段和`192.168.2.0/24`网段的直连路由，出接口分别指向各自子接口，证明路由器已经可以对 Vlan10 和 Vlan20 间的数据进行三层转发了*

   ![20210113-8](/home/garlic/Desktop/笔记/图片/20210113-8.PNG)

3. **测试在 PC3 上 Ping PC4 ，可以 Ping 通 PC4**

   ![20210113-9](/home/garlic/Desktop/笔记/图片/20210113-9.PNG)